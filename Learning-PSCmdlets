https://blogs.technet.microsoft.com/heyscriptingguy/tag/build-your-own-cmdlet/
